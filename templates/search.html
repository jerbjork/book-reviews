{% extends "layout.html" %}
{% block title %}Search{% endblock %}

{% block content %}
  <form action="/search" method="post">
    <p>
      Searchterm:
      {% if query %}
      {% if search == "tag" %}
      <input type="text" name="query" maxlength="100" minlength="3" required />
      {% else %}
      <input type="text" name="query" value="{{ query }}" maxlength="100" minlength="3" required />
      {% endif %}
      {% else %}
      <input type="text" name="query" maxlength="100" minlength="3" required/>
      {% endif %}
      <input type="hidden" name="search" value="search">
    </p>
    <input type="submit" value="Search" />
  </form>

  {% if query %}
  {% if results %}
  {% for result in results %}
    {% if result.removed == 0 %}
      <p>
      <a href="/review/{{ result.id }}">{{ result.title }}</a> submitted by  <a href="/user/{{ result.user_id }}">{{ result.username }}</a>
      </p>
    {% else %}
      <p>
        <a href="/review/{{ result.id }}">Removed</a> submitted by  {{ result.username }}
      </p>
    {% endif %}
  {% endfor %}
  {% else %}
  <p>No results found</p>
  {% endif %}
  {% endif %}

  <hr> 
  <p> Browse tags </p>
  {% for tag in tags %}
  <form action="/search" method="post">
    <p>
    <input type="hidden" name="query" value="{{ tag.title }}">
    <input type="submit" value="{{ tag.title }}" />
    <input type="hidden" name="search" value="tag">
    </p>
  </form>
  {% endfor %}
{% endblock %}